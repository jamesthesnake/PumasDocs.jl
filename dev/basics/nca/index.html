<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Noncompartmental Analysis (NCA) · Pumas</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>Pumas</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../">Home</a></li><li><span class="toctext">Tutorials</span><ul><li><a class="toctext" href="../../tutorials/introduction/">Introduction to Pumas</a></li></ul></li><li><span class="toctext">Basics</span><ul><li><a class="toctext" href="../overview/">Overview of Pumas</a></li><li><a class="toctext" href="../models/">Defining NLME Models</a></li><li><a class="toctext" href="../doses_subjects_populations/">Dosage Regimens, Subjects, and Populations</a></li><li><a class="toctext" href="../simulation/">Simulation of Pumas Models</a></li><li><a class="toctext" href="../estimation/">Estimating Parameters of Pumas Models</a></li><li class="current"><a class="toctext" href>Noncompartmental Analysis (NCA)</a><ul class="internal"><li><a class="toctext" href="#The-NCA-Functions-1">The NCA Functions</a></li><li><a class="toctext" href="#Analysis-Functionality-(Plots,-Reports,-DataFrame)-1">Analysis Functionality (Plots, Reports, DataFrame)</a></li><li><a class="toctext" href="#PumasNCADF-1">PumasNCADF</a></li></ul></li><li><a class="toctext" href="../faq/">Frequently Asked Questions (FAQ)</a></li></ul></li><li><span class="toctext">Model Components</span><ul><li><a class="toctext" href="../../model_components/domains/">Domains</a></li><li><a class="toctext" href="../../model_components/dosing_control/">Dosing Control Parameters (DCP)</a></li><li><a class="toctext" href="../../model_components/dynamical_types/">Dynamical Problem Types</a></li></ul></li><li><span class="toctext">Diagnostics</span><ul><li><a class="toctext" href="../../analysis/diagnostics/">Simulation and Estimation Diagnostics</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Basics</li><li><a href>Noncompartmental Analysis (NCA)</a></li></ul><a class="edit-page" href="https://github.com/PumasAI/PumasDocs.jl/blob/master/docs/src/basics/nca.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Noncompartmental Analysis (NCA)</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Noncompartmental-Analysis-(NCA)-1" href="#Noncompartmental-Analysis-(NCA)-1">Noncompartmental Analysis (NCA)</a></h1><p>NCA is performed in Pumas by creating <code>NCASubject</code> and <code>NCAPopulation</code> types which then preprocess the data to allow for easy generation of all NCA values. These types come with plotting, <code>DataFrame</code>, and <code>report</code> overloads to ease the analysis process.</p><h2><a class="nav-anchor" id="The-NCA-Functions-1" href="#The-NCA-Functions-1">The NCA Functions</a></h2><p>NCA functions can perform calculations on both <code>NCAPopulation</code> and <code>NCASubject</code>. When the input is a <code>NCAPopulation</code>, then the output is a <code>DataFrame</code>, and when the input is a <code>NCASubject</code>, the output is a number. The keyword argument <code>interval</code> takes a tuple of two numbers like <code>(1., 10.)</code> which will compute the quantity in the time interval, or <code>nothing</code> which will compute the quantity in the entire time span. The keyword argument <code>normalize</code> (normalize with respect to dosage) takes <code>true</code> or <code>false</code>. The keyword argument <code>auctype</code> (types of AUC) takes <code>:inf</code> or <code>:last</code>. The keyword argument <code>method</code> takes <code>:linear</code>, <code>:linuplogdown</code>, or <code>:linlog</code>. The keyword arguments <code>pred</code> (predicted) takes <code>true</code> or <code>false</code>. A description of the NCA output functions with the default arguments are as follows:</p><ul><li><code>n_samples(subj)</code>: the number of measurements that is above the lower limit of quantification.</li><li><code>dosetype(subj)</code>: route.</li><li><code>tau(subj)</code>: dosing interval.</li><li><code>doseamt(subj)</code>: dosage amount.</li><li><code>lambdaz(subj)</code>: terminal elimination rate constant (<span>$λz$</span>).</li><li><code>lambdazr2(subj)</code>: coefficient of determination (<span>$r²$</span>) when calculating <span>$λz$</span>. Note that is quantity must be computed after calculating <span>$λz$</span>.</li><li><code>lambdazadjr2(subj)</code>: adjusted coefficient of determination (<span>$adjr²$</span>) when calculating <span>$λz$</span>. Note that is quantity must be computed after calculating <span>$λz$</span>.</li><li><code>lambdazr(subj)</code>: correlation coefficient (<span>$r$</span>) when calculating <span>$λz$</span>. Note that is quantity must be computed after calculating <span>$λz$</span>.</li><li><code>lambdaznpoints(subj)</code>: number of points that is used in the <span>$λz$</span> calculation. Note that is quantity must be computed after calculating <span>$λz$</span>.</li><li><code>lambdazintercept(subj)</code>: <code>y</code>-intercept in the log-linear scale when calculating <span>$λz$</span>. Note that is quantity must be computed after calculating <span>$λz$</span>.</li><li><code>lambdaztimefirst(subj)</code>: the first time point that is used in the <span>$λz$</span> calculation. Note that is quantity must be computed after calculating <span>$λz$</span>.</li><li><code>lambdaztimelast(subj)</code>: the last time point that is used in the <span>$λz$</span> calculation. Note that is quantity must be computed after calculating <span>$λz$</span>.</li><li><code>thalf(subj)</code>: half life.</li><li><code>span(subj)</code>: <code>(lambdaztimelast(subj; kwargs...) - lambdaztimefirst(subj) / thalf(subj)</code>. Note that is quantity must be computed after calculating <span>$λz$</span>.</li><li><code>tmax(subj; interval=nothing)</code>: time of maximum concentration.</li><li><code>cmax(subj; interval=nothing, normalize=false)</code>: maximum concentration.</li><li><code>cmaxss(subj; normalize=false)</code>: steady-state maximum concentration.</li><li><code>tmin(subj)</code>: time of minimal concentration.</li><li><code>cmin(subj; normalize=false)</code>: minimum concentration.</li><li><code>cminss(subj; normalize=false)</code>: steady-state minimum concentration.</li><li><code>ctau(nca::NCASubject; method=:linear)</code>: concentration at the end of dosing interval.</li><li><code>cavgss(subj)</code>: average concentration over one period..</li><li><code>c0(subj)</code>: estimate the concentration at dosing time for an IV bolus dose.</li><li><code>tlast(subj)</code>: time of last measurable concentration.</li><li><code>clast(subj; pred=false)</code>: concentration corresponding to <code>tlast</code>.</li><li><code>tlag(subj)</code>: time prior to the first increase in concentration.</li><li><code>auc(subj; auctype=:inf, method=:linear, interval=nothing, normalize=false, pred=false)</code>: the area under the curve (AUC).</li><li><code>auctau(subj; method=:linear, interval=nothing, normalize=false, pred=false)</code>: the AUC in the dosing interval.</li><li><code>aumc(subj; auctype=:inf, method=:linear, interval=nothing, normalize=false, pred=false)</code>: the area under the first moment of the concentration (AUMC).</li><li><code>aumctau(subj; method=:linear, interval=nothing, normalize=false, pred=false)</code>: the AUMC in the dosing interval.</li><li><code>vz(subj; pred=false)</code>: volume of distribution during the terminal phase.</li><li><code>cl(subj; pred=false)</code>: total drug clearance.</li><li><code>vss(subj; pred=false)</code>: apparent volume of distribution at equilibrium for IV bolus doses.</li><li><code>fluctuation(nca; usetau=false)</code>: peak trough fluctuation over one dosing interval at steady state. It is <span>$100*(C_{maxss} - C_{minss})/C_{avgss}$</span> (usetau=false) or <span>$100*(C_{maxss} - C_{tau})/C_{avgss}$</span> (usetau=true).</li><li><code>accumulationindex(subj)</code>: theoretical accumulation ratio.</li><li><code>auc_extrap_percent(subj; pred=false)</code>: the percentage of AUC infinity due to extrapolation from <code>tlast</code>.</li><li><code>auc_back_extrap_percent(subj; pred=false)</code>: the percentage of AUC infinity due to back extrapolation of <code>c0</code>.</li><li><code>aumc_extrap_percent(subj; pred=false)</code>: the percentage of AUMC infinity due to extrapolation from <code>tlast</code>.</li><li><code>aumc_back_extrap_percent(subj; pred=false)</code>: the percentage of AUMC infinity due to back extrapolation of <code>c0</code>.</li><li><code>mrt(subj; auctype=:inf)</code>: mean residence time from the time of dosing to the time of the last measurable concentration.</li><li><code>swing(subj; usetau=false)</code>: swing. It is <span>$swing = (C_{maxss}-C_{minss})/C_{minss}$</span> (usetau=false) or <span>$swing = (C_{maxss}-C_{tau})/C_{tau}$</span> (usetau=true).</li></ul><p>For urine analysis the functions are:</p><ul><li><code>n_samples(subj)</code>: the number of measurements that is above the lower limit of quantification.</li><li><code>dosetype(subj)</code>: route.</li><li><code>doseamt(subj)</code>: dosage amount.</li><li><code>urine_volume(subj)</code>: urine volume.</li><li><code>lambdaz(subj)</code>: terminal elimination rate constant (<span>$λz$</span>).</li><li><code>lambdazr2(subj)</code>: coefficient of determination (<span>$r²$</span>) when calculating <span>$λz$</span>. Note that is quantity must be computed after calculating <span>$λz$</span>.</li><li><code>lambdazadjr2(subj)</code>: adjusted coefficient of determination (<span>$adjr²$</span>) when calculating <span>$λz$</span>. Note that is quantity must be computed after calculating <span>$λz$</span>.</li><li><code>lambdazr(subj)</code>: correlation coefficient (<span>$r$</span>) when calculating <span>$λz$</span>. Note that is quantity must be computed after calculating <span>$λz$</span>.</li><li><code>lambdaznpoints(subj)</code>: number of points that is used in the <span>$λz$</span> calculation. Note that is quantity must be computed after calculating <span>$λz$</span>.</li><li><code>lambdazintercept(subj)</code>: <code>y</code>-intercept in the log-linear scale when calculating <span>$λz$</span>. Note that is quantity must be computed after calculating <span>$λz$</span>.</li><li><code>lambdaztimefirst(subj)</code>: the first time point that is used in the <span>$λz$</span> calculation. Note that is quantity must be computed after calculating <span>$λz$</span>.</li><li><code>lambdaztimelast(subj)</code>: the last time point that is used in the <span>$λz$</span> calculation. Note that is quantity must be computed after calculating <span>$λz$</span>.</li><li><code>thalf(subj)</code>: half life.</li><li><code>span(subj)</code>: <code>(lambdaztimelast(subj; kwargs...) - lambdaztimefirst(subj) / thalf(subj)</code>. Note that is quantity must be computed after calculating <span>$λz$</span>.</li><li><code>tlag(subj)</code>: time prior to the first increase in concentration.</li><li><code>tmax_rate(subj)</code>: midpoint of collection interval associated with the maximum observed excretion rate.</li><li><code>max_rate(subj)</code>: maximum observed excretion rate.</li><li><code>rate_last(subj; pred=false)</code>: last measurable rate.</li><li><code>mid_time_last(subj)</code>: midpoint of collection interval associated with <code>rate_last</code>.</li><li><code>amount_recovered(subj)</code>: cumulative amount eliminated.</li><li><code>percent_recovered(subj)</code>: <code>100*amount_recovered/doseamt</code>.</li><li><code>aurc(subj; auctype=:inf, method=:linear, interval=nothing, normalize=false, pred=false)</code>: the area under the urinary excretion rate curve (AURC).</li><li><code>aurc_extrap_percent(subj; pred=false)</code>: the percentage of AURC infinity due to extrapolation from <code>tlast</code>.</li></ul><p>These functions are all accessed from within the NCA submodule. For example, to use <code>auc</code> on <code>NCAPopulation</code>, one would use <code>NCA.auc(pop)</code>.</p><h2><a class="nav-anchor" id="Analysis-Functionality-(Plots,-Reports,-DataFrame)-1" href="#Analysis-Functionality-(Plots,-Reports,-DataFrame)-1">Analysis Functionality (Plots, Reports, DataFrame)</a></h2><p>To plot <code>NCASubject</code> or <code>NCAPopulation</code>:</p><pre><code class="language-julia">plot(subj; linear=true, loglinear=true, kwargs...)</code></pre><p>when <code>linear=true</code> the plot in linear-linear scale will be shown, and when <code>loglinear=true</code> the plot in linear-logarithmic scale will be shown. Please consult <a href="http://docs.juliaplots.org/latest/">Plots.jl&#39;s documentation</a> for more information on the additional arguments and plotting functions.</p><p>To report NCA quantities in <code>DataFrame</code>:</p><pre><code class="language-julia">report = NCAReport(pop; sigdigits=nothing, kwargs...)
report_df = to_dataframe(report)</code></pre><p><code>sigdigits</code> defaults to <code>nothing</code>, so all reporting quantities are in full <code>Float64</code> precision. To truncate extraneous digits, one can do <code>sigdigits=4</code>. One can put additional arguments (<code>kwargs...</code>) to <code>NCAReport</code>, and they will be passed all NCA functions.</p><h2><a class="nav-anchor" id="PumasNCADF-1" href="#PumasNCADF-1">PumasNCADF</a></h2><p>The PumasNCADF is a standardized format for tabular data for NCA. The format has the following columns:</p><ul><li><code>id</code>: the string <code>id</code> of the subject.</li><li><code>conc</code>: the concentration time series measurements. Values must be floating point numbers or missing.</li><li><code>time</code>: the time at which the concentration was measured.</li><li><code>occasion</code>: the occasion for the observation. Must be an integer value at each time point.</li><li><code>amt</code>: the amount of a dose. Must be a floating point value at each dosing time, and otherwise missing.</li><li><code>route</code>: the route of administration. Possible choices are <code>iv</code> for intravenous, <code>ev</code> for extravascular, and <code>inf</code> for infusion.</li><li><code>duration</code>: the infusion duration. Should be a floating point value or missing.</li><li>Grouping variables: Any additional column may be chosen as for grouping the output by.</li></ul><p>For urine analysis, the format has the follows columns:</p><ul><li><code>id</code>: the string <code>id</code> of the subject.</li><li><code>conc</code>: the concentration time series measurements.</li><li><code>voumne</code>: urine volume.</li><li><code>start_time</code>: the beginning of the collection time.</li><li><code>end_time</code>: the end of the collection time.</li><li><code>amt</code>: the amount of a dose. Must be a floating point value at each dosing time, and otherwise missing.</li><li><code>route</code>: the route of administration. Possible choices are <code>iv</code> for intravenous, <code>ev</code> for extravascular, and <code>inf</code> for infusion.</li><li><code>duration</code>: the infusion duration. Should be a floating point value or missing.</li><li>Grouping variables: Any additional column may be chosen as for grouping the output by.</li></ul><h3><a class="nav-anchor" id="Parsing-PumasNCADF-1" href="#Parsing-PumasNCADF-1">Parsing PumasNCADF</a></h3><p>The parsing function for the PumasNCADF is as follows:</p><pre><code class="language-julia">read_nca(df; group=nothing, ii=:ii, ss=:ss, blq=:blq
                  concu=true, timeu=true, amtu=true, volumeu=true, verbose=true)</code></pre><p>These arguments are:</p><ul><li><code>df</code>: the required positional argument. This is either a string which is the path to a CSV file, or a <code>DataFrame</code> of tabular data for use in the NCA.</li><li><code>group</code>: the column to group the output by. Defaults to no grouping.</li><li><code>ii</code>: the interdose interval. Used to specify the interval length for steady state dosing.</li><li><code>ss</code>: the steady-state. Used to specify whether a dose is steady-state, a steady-state dose takes the value 1 and 0 otherwise. Defaults to the <code>:ss</code> column.</li><li><code>blq</code>: below the lower limit of quantification (BLQ). Used to specify the concentration that is BLQ, BLQ column takes the value 1 and 0 otherwise. Defaults to the <code>:blq</code> column.</li><li><code>concu</code>: the units for concentration. Defaults to no units.</li><li><code>amtu</code>: the units for dosing amount. Defaults to no units.</li><li><code>timeu</code>: the units for time. Defaults to no units.</li><li><code>volumeu</code>: the units for volume. Defaults to no units.</li><li><code>verbose</code>: When true, warnings will be thrown when the output is does not match PumasNCADF. Defaults to true.</li></ul><footer><hr/><a class="previous" href="../estimation/"><span class="direction">Previous</span><span class="title">Estimating Parameters of Pumas Models</span></a><a class="next" href="../faq/"><span class="direction">Next</span><span class="title">Frequently Asked Questions (FAQ)</span></a></footer></article></body></html>
