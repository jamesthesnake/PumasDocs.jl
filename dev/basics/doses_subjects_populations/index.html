<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Dosage Regimens, Subjects, and Populations · Pumas</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>Pumas</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../">Home</a></li><li><span class="toctext">Tutorials</span><ul><li><a class="toctext" href="../../tutorials/introduction/">Introduction to Pumas</a></li></ul></li><li><span class="toctext">Basics</span><ul><li><a class="toctext" href="../overview/">Overview of Pumas</a></li><li><a class="toctext" href="../models/">Defining NLME Models</a></li><li class="current"><a class="toctext" href>Dosage Regimens, Subjects, and Populations</a><ul class="internal"><li><a class="toctext" href="#Dosage-Regimen-Terminology-1">Dosage Regimen Terminology</a></li><li><a class="toctext" href="#The-Subject-Constructor-1">The Subject Constructor</a></li><li><a class="toctext" href="#The-Population-Constructor-1">The Population Constructor</a></li><li><a class="toctext" href="#PumasNDF-1">PumasNDF</a></li></ul></li><li><a class="toctext" href="../simulation/">Simulation of Pumas Models</a></li><li><a class="toctext" href="../estimation/">Estimating Parameters of Pumas Models</a></li><li><a class="toctext" href="../nca/">Noncompartmental Analysis (NCA)</a></li><li><a class="toctext" href="../faq/">Frequently Asked Questions (FAQ)</a></li></ul></li><li><span class="toctext">Model Components</span><ul><li><a class="toctext" href="../../model_components/domains/">Domains</a></li><li><a class="toctext" href="../../model_components/dosing_control/">Dosing Control Parameters (DCP)</a></li><li><a class="toctext" href="../../model_components/dynamical_types/">Dynamical Problem Types</a></li></ul></li><li><span class="toctext">Diagnostics</span><ul><li><a class="toctext" href="../../analysis/diagnostics/">Simulation and Estimation Diagnostics</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Basics</li><li><a href>Dosage Regimens, Subjects, and Populations</a></li></ul><a class="edit-page" href="https://github.com/PumasAI/PumasDocs.jl/blob/master/docs/src/basics/doses_subjects_populations.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Dosage Regimens, Subjects, and Populations</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Dosage-Regimens,-Subjects,-and-Populations-1" href="#Dosage-Regimens,-Subjects,-and-Populations-1">Dosage Regimens, Subjects, and Populations</a></h1><p>The data is passed to a Pumas model via the <code>Population</code> type. A <code>Population</code> is a collection of <code>Subject</code>s. In this section we will specify the methods used for defining <code>Subject</code>s and <code>Population</code>s. These types can either be defined programmatically using the <code>Subject</code> and <code>Population</code> constructors on Julia types or by using the Pumas NLME Data format (named PumasNDF).</p><h2><a class="nav-anchor" id="Dosage-Regimen-Terminology-1" href="#Dosage-Regimen-Terminology-1">Dosage Regimen Terminology</a></h2><p>Both the <code>DosageRegimen</code> and the <code>PumasNDF</code> utilize the same terminology for describing a dose. The definition of the values are as follows:</p><ul><li><code>amt</code>: the amount of the dose. This is the only required value.</li><li><code>time</code>: the time at which the dose is given. Defaults to 0.</li><li><code>evid</code>: the event id. <code>1</code> specifies a normal event. <code>3</code> means it&#39;s a reset event, meaning that the value of the dynamical variable is reset to the <code>amt</code> at the dosing event. If <code>4</code>, then the value is reset (to the steady state), and then a final dose is given. Defaults to <code>1</code>.</li><li><code>ii</code>: the interdose interval. For steady state events, this is the length of time between successive doses. When <code>addl</code> is specified, this is the length of time to the next dose. Defaults to <code>0</code>.</li><li><code>addl</code>: the number of additional events of the same types, spaced by <code>ii</code>. Defaults to 0.</li><li><code>rate</code>: the rate of administration. If <code>0</code>, then the dose is instantaneous. Otherwise the dose is administrated at a constant rate for a duration equal to <code>amt/rate</code>.</li><li><code>ss</code>: an indicator for whether the dose is a steady state dose. A steady state dose is defined as the result of having applied the dose with the interval <code>ii</code> infinitely many successive times. <code>0</code> indicates that the dose is not a steady state dose. 1 indicates that the dose is a steady state dose. 2 indicates that it is a steady state dose that is added to the previous amount. The default is 0.</li></ul><h2><a class="nav-anchor" id="The-Subject-Constructor-1" href="#The-Subject-Constructor-1">The Subject Constructor</a></h2><p>A <code>Subject</code> can be constructed using the following constructor:</p><pre><code class="language-julia">Subject(;id = 1,
         obs = nothing,
         cvs = nothing,
         evs = Event[],
         time = obs isa AbstractDataFrame ? obs.time : nothing
         )</code></pre><p>The definitions of the arguments are as follows:</p><ul><li><code>id</code> is the id of the subject. Defaults to <code>1</code>.</li><li><code>obs</code> is a Julia type which holds the observational data. When using the <code>@model</code> interface, this must be a <code>NamedTuple</code> whose names match those of the derived variables.</li><li><code>cvs</code> are the covariates for the subject. It can be any Julia type when working with the function-based interface, but must be a <code>NamedTuple</code> for the <code>@model</code> interface. Defaults to <code>nothing</code>, meaning no covariates.</li><li><code>evs</code> is a <code>DosageRegimen</code>. Defaults to an empty event list.</li><li><code>time</code> is the list of times associated with the observations.</li></ul><h3><a class="nav-anchor" id="DosageRegimen-1" href="#DosageRegimen-1"><code>DosageRegimen</code></a></h3><p>The <code>DosageRegimen</code> type is a specification of a regimen. Its constructor is:</p><pre><code class="language-julia">DosageRegimen(amt;
              time = 0,
              cmt  = 1,
              evid = 1,
              ii   = zero.(time),
              addl = 0,
              rate = zero.(amt)./oneunit.(time),
              ss   = 0)</code></pre><p>Each of the values can either be <code>AbstractVector</code>s or scalars. All vectors must be of the same length, and the elementwise combinations each define an event (with scalars being repeated).</p><p>Additionally, multiple <code>DosageRegimen</code>s can be combined to form a <code>DosageRegimen</code>. For example, if we have:</p><pre><code class="language-julia">dr1 = DosageRegimen(100, ii = 24, addl = 6)
dr2 = DosageRegimen(50,  ii = 12, addl = 13)
dr3 = DosageRegimen(200, ii = 24, addl = 2)</code></pre><p>then the following is the <code>DosageRegimen</code> for the combination of all doses:</p><pre><code class="language-julia">dr = DosageRegimen(e1, e2, e3)</code></pre><p>The current <code>DosageRegimen</code> can be viewed in its tabular form using the <code>DataFrame</code> function: <code>DataFrame(dr)</code>.</p><h2><a class="nav-anchor" id="The-Population-Constructor-1" href="#The-Population-Constructor-1">The Population Constructor</a></h2><p>The <code>Population</code> constructor is simply <code>Population(subjects)</code>, where <code>subjects</code> is a collection of <code>Subject</code>s.</p><h2><a class="nav-anchor" id="PumasNDF-1" href="#PumasNDF-1">PumasNDF</a></h2><p>The PumasNDF is a specification for building a <code>Population</code> from tabular data. Generally this tabular data is given by a database like a CSV. The CSV has columns described as follows:</p><ul><li><code>id</code>: the ID of the individual. Each individual should have a unique integer, or string.</li><li><code>time</code>: the time corresponding to the row. Should be unique per id, i.e. no duplicate time values for a given subject.</li><li><code>evid</code>: the event id. <code>1</code> specifies a normal event. <code>3</code> means it&#39;s a reset event, meaning that the value of the dynamical variable is reset to the <code>amt</code> at the dosing event. If <code>4</code>, then the value is reset (to the steady state), and then a final dose is given. Defaults to <code>0</code> if amt is <code>0</code> or missing, and 1 otherwise.</li><li><code>amt</code>: the amount of the dose. If the <code>evid</code> column exists and is non-zero, this value should be non-zero. Defaults to <code>0</code>.</li><li><code>ii</code>: the interdose interval. When <code>addl</code> is specified, this is the length of time to the next dose. For steady state events, this is the length of time between successive doses. Defaults to <code>0</code>, and is required to be non-zero on rows where a steady-state event is specified.  </li><li><code>addl</code>: the number of additional doses of the same time to give. Defaults to 0.</li><li><code>rate</code>: the rate of administration. If <code>0</code>, then the dose is instantaneous. Otherwise the dose is administrated at a constant rate for a duration equal to <code>amt/rate</code>. A <code>rate=-2</code> allows the <code>rate</code> to be determined by a <a href="../../model_components/dosing_control/#Dosing-Control-Parameters-(DCP)-1">Dosing Control Parameters (DCP)</a>. Defaults to <code>0</code>.</li><li><code>ss</code>: an indicator for whether the dose is a steady state dose. A steady state dose is defined as the result of having applied the dose with the interval <code>ii</code> infinitely many successive times. <code>0</code> indicates that the dose is not a steady state dose. <code>1</code> indicates that the dose is a steady state dose. <code>2</code> indicates that it is a steady state dose that is added to the previous amount. The default is <code>0</code>.</li><li><code>cmt</code>: the compartment being dosed. Defaults to <code>1</code>.</li><li><code>duration</code>: the duration of administration. If <code>0</code>, then the dose is instantaneous. Otherwise the dose is administered at a constant rate equal to <code>amt/duration</code>. Defaults to <code>0</code>.</li><li>Observation and covariate columns should be given as a time series of values of matching type. Constant covariates should be constant through the full column. Time points without a measurement should be denoted by a <code>.</code>.</li></ul><p>If a column does not exists, its values are imputed to be the defaults. Special notes:</p><ul><li>If <code>rate</code> and <code>duration</code> exist, then it is enforced that <code>amt=rate*duration</code></li><li>All values and header names are interpreted as lower case.</li></ul><h3><a class="nav-anchor" id="PumasNDF-Parsing-1" href="#PumasNDF-Parsing-1">PumasNDF Parsing</a></h3><pre><code class="language-julia">read_Pumas(data;vs=Symbol[],dvs=Symbol[:dv]
                        id=:id, time=:time, evid=:evid, amt=:amt, addl=:addl,
                        ii=:ii, cmt=:cmt, rate=:rate, ss=:ss)</code></pre><p>The arguments are as follows:</p><ul><li><code>data</code> is the tabular data source. If a string path to a CSV is given, then it will read the CSV file from that location in the file system. If a Julia-based tabular data structure is given, such as a <a href="http://juliadata.github.io/DataFrames.jl/stable/">DataFrame</a>, then that structure will be used as the data source.</li><li><code>cvs</code> is the list of symbols for the header names of the covariate columns.</li><li><code>dvs</code> is the list of symbols for the header names of the observation data columns.</li></ul><p>The other arguments are optional and allow changing the column names from their default.</p><h3><a class="nav-anchor" id="NMTRAN-Parsing-1" href="#NMTRAN-Parsing-1">NMTRAN Parsing</a></h3><p>Additionally, there exist a parsing function <code>process_nmtran</code> for parsing general NONMEM files. This function is a work-in-progress.</p><pre><code class="language-julia">process_nmtran(data,cvs=Symbol[],dvs=Symbol[:dv];
                        id=:id, time=:time, evid=:evid, amt=:amt, addl=:addl,
                        ii=:ii, cmt=:cmt, rate=:rate, ss=:ss)</code></pre><footer><hr/><a class="previous" href="../models/"><span class="direction">Previous</span><span class="title">Defining NLME Models</span></a><a class="next" href="../simulation/"><span class="direction">Next</span><span class="title">Simulation of Pumas Models</span></a></footer></article></body></html>
